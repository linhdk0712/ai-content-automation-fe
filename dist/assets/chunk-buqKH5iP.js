import{m as n,n as t,u as i,r as e,j as r,a}from"./chunk-BLWUN8J3.js";import{al as c,d as h,B as o,ay as d,e as l,g as s,aB as m,as as g,k as y,at as u,f as p,a1 as v,a4 as b,H as x,aC as f,J as k,aD as T,O as I,aE as C,aA as w,aF as N,aG as S,ar as W,Q as P,R as _,aH as D,aI as K,aJ as V,i as j,aK as B,aq as M}from"./chunk-IloZ2OGx.js";const O=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{paymentId:W}=n(),[P]=t(),_=i(),[D,K]=e.useState(null),[V,j]=e.useState(!0),[B,M]=e.useState(null);e.useEffect(()=>{if(W)O();else{const n=P.get("vnp_TxnRef")||P.get("orderId");n?R(n):(M("Không tìm thấy thông tin thanh toán"),j(!1))}},[W,P]);const O=async()=>{try{const n=await fetch(`/api/v1/payments/${W}`);if(n.ok){const t=await n.json();K(t)}else M("Không thể tải thông tin thanh toán")}catch(n){M("Có lỗi xảy ra khi tải thông tin thanh toán")}finally{j(!1)}},R=async n=>{try{const t=await fetch(`/api/v1/payments/transaction/${n}`);if(t.ok){const n=await t.json();K(n)}else M("Không tìm thấy giao dịch")}catch(t){M("Có lỗi xảy ra khi tải thông tin giao dịch")}finally{j(!1)}};return V?r(d,{maxWidth:"sm",sx:{py:8},children:a(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:2,children:[r(c,{size:60}),r(h,{variant:"h6",children:"Đang xử lý thông tin thanh toán..."})]})}):a(d,B||!D?{maxWidth:"sm",sx:{py:8},children:[r(l,{severity:"error",sx:{mb:3},children:B||"Không tìm thấy thông tin thanh toán"}),r(o,{textAlign:"center",children:r(s,{variant:"contained",onClick:()=>_("/"),startIcon:r(m,{}),children:"Về trang chủ"})})]}:{maxWidth:"md",sx:{py:4},children:[a(o,{textAlign:"center",mb:4,children:[r(g,{sx:{fontSize:80,color:"success.main",mb:2}}),r(h,{variant:"h3",fontWeight:"bold",color:"success.main",gutterBottom:!0,children:"Thanh Toán Thành Công!"}),r(h,{variant:"h6",color:"text.secondary",children:"Cảm ơn bạn đã sử dụng dịch vụ của chúng tôi"})]}),r(p,{elevation:3,sx:{mb:4},children:a(y,{sx:{p:4},children:[r(h,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:"Chi Tiết Thanh Toán"}),a(u,{container:!0,spacing:3,children:[a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Số tiền"}),r(h,{variant:"h4",fontWeight:"bold",color:"primary",children:(A=D.amount,F=D.currency,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"===F?"VND":"USD",minimumFractionDigits:0}).format(A))})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Trạng thái"}),a(o,{display:"flex",alignItems:"center",gap:1,children:[r(g,{color:"success"}),r(h,{variant:"h6",color:"success.main",children:"Thành công"})]})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Phương thức thanh toán"}),r(h,{variant:"body1",children:"VNPAY"===D.paymentProvider?"VNPay":"MOMO"===D.paymentProvider?"MoMo":D.paymentProvider})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Thời gian xử lý"}),r(h,{variant:"body1",children:(L=D.processedAt,new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(L)))})]}),a(u,{item:!0,xs:12,children:[r(h,{variant:"body2",color:"text.secondary",children:"Mô tả"}),r(h,{variant:"body1",children:D.description})]}),D.planType&&a(u,{item:!0,xs:12,children:[r(h,{variant:"body2",color:"text.secondary",children:"Gói đăng ký"}),r(h,{variant:"body1",fontWeight:"medium",children:(n=>{switch(n){case"BASIC":return"Gói Cơ Bản";case"PRO":return"Gói Chuyên Nghiệp";case"ENTERPRISE":return"Gói Doanh Nghiệp";default:return n||""}})(D.planType)})]}),D.invoiceNumber&&a(u,{item:!0,xs:12,children:[r(h,{variant:"body2",color:"text.secondary",children:"Số hóa đơn"}),r(h,{variant:"body1",fontFamily:"monospace",children:D.invoiceNumber})]})]})]})}),r(p,{elevation:2,sx:{mb:4},children:a(y,{children:[r(h,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Bước Tiếp Theo"}),a(v,{children:[a(b,{children:[r(x,{children:r(f,{color:"success"})}),r(k,{primary:"Email xác nhận đã được gửi",secondary:"Kiểm tra hộp thư của bạn để xem chi tiết giao dịch"})]}),D.subscriptionId&&a(b,{children:[r(x,{children:r(f,{color:"success"})}),r(k,{primary:"Gói đăng ký đã được kích hoạt",secondary:"Bạn có thể bắt đầu sử dụng các tính năng premium ngay bây giờ"})]}),a(b,{children:[r(x,{children:r(f,{color:"success"})}),r(k,{primary:"Hóa đơn có thể tải xuống",secondary:"Sử dụng nút bên dưới để tải hóa đơn PDF"})]})]})]})}),a(u,{container:!0,spacing:2,sx:{mb:4},children:[D.invoiceNumber&&r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"contained",fullWidth:!0,startIcon:r(T,{}),onClick:async()=>{if(null==D?void 0:D.invoiceNumber)try{const n=await fetch(`/api/v1/invoices/${D.invoiceNumber}/download`);if(n.ok){const t=await n.blob(),i=window.URL.createObjectURL(t),e=document.createElement("a");e.href=i,e.download=`invoice-${D.invoiceNumber}.pdf`,document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(i),document.body.removeChild(e)}}catch(n){}},children:"Tải hóa đơn"})}),D.subscriptionId&&r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(I,{}),onClick:()=>_("/subscription"),children:"Quản lý gói"})}),r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(C,{}),onClick:()=>_("/payment-history"),children:"Lịch sử thanh toán"})}),r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(m,{}),onClick:()=>_("/dashboard"),children:"Về Dashboard"})})]}),a(w,{elevation:1,sx:{p:3,bgcolor:"grey.50"},children:[r(h,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Cần Hỗ Trợ?"}),r(h,{variant:"body2",color:"text.secondary",mb:2,children:"Nếu bạn có bất kỳ câu hỏi nào về giao dịch này, vui lòng liên hệ với chúng tôi:"}),a(u,{container:!0,spacing:2,children:[r(u,{item:!0,xs:12,sm:6,children:a(o,{display:"flex",alignItems:"center",gap:1,children:[r(N,{color:"primary"}),r(h,{variant:"body2",children:"support@aicontentautomation.com"})]})}),r(u,{item:!0,xs:12,sm:6,children:a(o,{display:"flex",alignItems:"center",gap:1,children:[r(S,{color:"primary"}),r(h,{variant:"body2",children:"1900 1234 (8:00 - 22:00)"})]})})]})]})]});var L,A,F}},Symbol.toStringTag,{value:"Module"})),R=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{paymentId:g}=n(),[f]=t(),T=i(),[I,C]=e.useState(null),[O,R]=e.useState(!0),[L,A]=e.useState(null),[F,G]=e.useState(!1);e.useEffect(()=>{if(g)E();else{const n=f.get("vnp_TxnRef")||f.get("orderId");n?H(n):(A("Không tìm thấy thông tin thanh toán"),R(!1))}},[g,f]);const E=async()=>{try{const n=await fetch(`/api/v1/payments/${g}`);if(n.ok){const t=await n.json();C(t)}else A("Không thể tải thông tin thanh toán")}catch(n){A("Có lỗi xảy ra khi tải thông tin thanh toán")}finally{R(!1)}},H=async n=>{try{const t=await fetch(`/api/v1/payments/transaction/${n}`);if(t.ok){const n=await t.json();C(n)}else A("Không tìm thấy giao dịch")}catch(t){A("Có lỗi xảy ra khi tải thông tin giao dịch")}finally{R(!1)}};return O?r(d,{maxWidth:"sm",sx:{py:8},children:a(o,{display:"flex",flexDirection:"column",alignItems:"center",gap:2,children:[r(c,{size:60}),r(h,{variant:"h6",children:"Đang xử lý thông tin thanh toán..."})]})}):a(d,L||!I?{maxWidth:"sm",sx:{py:8},children:[r(l,{severity:"error",sx:{mb:3},children:L||"Không tìm thấy thông tin thanh toán"}),r(o,{textAlign:"center",children:r(s,{variant:"contained",onClick:()=>T("/"),startIcon:r(m,{}),children:"Về trang chủ"})})]}:{maxWidth:"md",sx:{py:4},children:[a(o,{textAlign:"center",mb:4,children:[r(W,{sx:{fontSize:80,color:"error.main",mb:2}}),r(h,{variant:"h3",fontWeight:"bold",color:"error.main",gutterBottom:!0,children:"Thanh Toán Thất Bại"}),r(h,{variant:"h6",color:"text.secondary",children:"Rất tiếc, giao dịch của bạn không thể hoàn thành"})]}),r(l,{severity:"error",sx:{mb:4},children:a(h,{variant:"body1",fontWeight:"medium",children:["Lý do: ",(n=>{if(!n)return"Không xác định được lý do thất bại";return{insufficient_funds:"Số dư tài khoản không đủ",card_declined:"Thẻ bị từ chối",expired_card:"Thẻ đã hết hạn",invalid_card:"Thông tin thẻ không hợp lệ",network_error:"Lỗi kết nối mạng",timeout:"Hết thời gian chờ",cancelled_by_user:"Người dùng hủy giao dịch",payment_expired:"Giao dịch đã hết hạn",system_error:"Lỗi hệ thống"}[n]||n})(I.failureReason)]})}),r(p,{elevation:3,sx:{mb:4},children:a(y,{sx:{p:4},children:[r(h,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:"Chi Tiết Giao Dịch"}),a(u,{container:!0,spacing:3,children:[a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Số tiền"}),r(h,{variant:"h4",fontWeight:"bold",children:($=I.amount,J=I.currency,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"===J?"VND":"USD",minimumFractionDigits:0}).format($))})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Trạng thái"}),a(o,{display:"flex",alignItems:"center",gap:1,children:[r(W,{color:"error"}),r(h,{variant:"h6",color:"error.main",children:"Thất bại"})]})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Phương thức thanh toán"}),r(h,{variant:"body1",children:"VNPAY"===I.paymentProvider?"VNPay":"MOMO"===I.paymentProvider?"MoMo":I.paymentProvider})]}),a(u,{item:!0,xs:12,sm:6,children:[r(h,{variant:"body2",color:"text.secondary",children:"Thời gian tạo"}),r(h,{variant:"body1",children:(z=I.createdAt,new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(z)))})]}),a(u,{item:!0,xs:12,children:[r(h,{variant:"body2",color:"text.secondary",children:"Mô tả"}),r(h,{variant:"body1",children:I.description})]}),a(u,{item:!0,xs:12,children:[r(h,{variant:"body2",color:"text.secondary",children:"Mã giao dịch"}),r(h,{variant:"body1",fontFamily:"monospace",children:I.providerTransactionId})]})]})]})}),r(p,{elevation:2,sx:{mb:4},children:a(y,{children:[r(h,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Cách Khắc Phục"}),r(v,{children:(U=I.failureReason,{insufficient_funds:["Kiểm tra số dư tài khoản","Nạp thêm tiền vào tài khoản","Sử dụng phương thức thanh toán khác"],card_declined:["Liên hệ ngân hàng để kiểm tra thẻ","Kiểm tra giới hạn giao dịch","Thử sử dụng thẻ khác"],expired_card:["Cập nhật thông tin thẻ mới","Sử dụng thẻ khác còn hiệu lực"],network_error:["Kiểm tra kết nối internet","Thử lại sau vài phút","Sử dụng mạng khác nếu có thể"]}[U||""]||["Kiểm tra kết nối internet của bạn","Đảm bảo thông tin thanh toán chính xác","Thử lại sau vài phút","Liên hệ ngân hàng nếu vấn đề tiếp tục"]).map((n,t)=>a(b,{children:[r(x,{children:r(P,{color:"primary"})}),r(k,{primary:n})]},t))})]})}),a(u,{container:!0,spacing:2,sx:{mb:4},children:[r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"contained",fullWidth:!0,startIcon:r(_,{}),onClick:async()=>{if(I){G(!0);try{const n=await fetch("/api/v1/payments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:I.amount,currency:I.currency,paymentMethod:I.paymentMethod,paymentProvider:I.paymentProvider,description:I.description})});if(n.ok){const t=await n.json();window.location.href=t.providerPaymentUrl}else A("Không thể tạo giao dịch mới")}catch(n){A("Có lỗi xảy ra khi thử lại thanh toán")}finally{G(!1)}}},disabled:F,children:F?"Đang xử lý...":"Thử lại"})}),r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(D,{}),onClick:()=>T("/pricing"),children:"Chọn phương thức khác"})}),r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(P,{}),onClick:()=>T("/support"),children:"Liên hệ hỗ trợ"})}),r(u,{item:!0,xs:12,sm:6,md:3,children:r(s,{variant:"outlined",fullWidth:!0,startIcon:r(m,{}),onClick:()=>T("/dashboard"),children:"Về Dashboard"})})]}),r(p,{elevation:1,sx:{mb:4},children:a(y,{children:[r(h,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"Câu Hỏi Thường Gặp"}),a(K,{children:[r(V,{expandIcon:r(j,{}),children:r(h,{children:"Tại sao thanh toán của tôi bị từ chối?"})}),r(B,{children:r(h,{variant:"body2",color:"text.secondary",children:"Thanh toán có thể bị từ chối do nhiều lý do như số dư không đủ, thông tin thẻ không chính xác, hoặc ngân hàng từ chối giao dịch. Vui lòng kiểm tra lại thông tin và thử lại."})})]}),a(K,{children:[r(V,{expandIcon:r(j,{}),children:r(h,{children:"Tiền có bị trừ khỏi tài khoản không?"})}),r(B,{children:r(h,{variant:"body2",color:"text.secondary",children:"Nếu giao dịch thất bại, tiền sẽ không bị trừ khỏi tài khoản của bạn. Trong trường hợp có tạm giữ, số tiền sẽ được hoàn lại trong 1-3 ngày làm việc."})})]}),a(K,{children:[r(V,{expandIcon:r(j,{}),children:r(h,{children:"Tôi có thể thử lại ngay không?"})}),r(B,{children:r(h,{variant:"body2",color:"text.secondary",children:"Có, bạn có thể thử lại ngay lập tức. Tuy nhiên, nếu giao dịch tiếp tục thất bại, hãy chờ vài phút hoặc liên hệ ngân hàng để được hỗ trợ."})})]})]})}),a(w,{elevation:1,sx:{p:3,bgcolor:"grey.50"},children:[a(o,{display:"flex",alignItems:"center",gap:1,mb:2,children:[r(M,{color:"warning"}),r(h,{variant:"h6",fontWeight:"bold",children:"Cần Hỗ Trợ Khẩn Cấp?"})]}),r(h,{variant:"body2",color:"text.secondary",mb:2,children:"Đội ngũ hỗ trợ của chúng tôi sẵn sàng giúp bạn giải quyết vấn đề thanh toán:"}),a(u,{container:!0,spacing:2,children:[r(u,{item:!0,xs:12,sm:6,children:a(o,{display:"flex",alignItems:"center",gap:1,children:[r(N,{color:"primary"}),r(h,{variant:"body2",children:"support@aicontentautomation.com"})]})}),r(u,{item:!0,xs:12,sm:6,children:a(o,{display:"flex",alignItems:"center",gap:1,children:[r(S,{color:"primary"}),r(h,{variant:"body2",children:"1900 1234 (24/7)"})]})})]})]})]});var U,z,$,J}},Symbol.toStringTag,{value:"Module"}));export{O as P,R as a};
